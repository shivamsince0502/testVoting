{"version":3,"file":"schema.js","sourceRoot":"","sources":["../../../../lib/modules/datasource/azure-bicep-resource/schema.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AAEX,QAAA,yBAAyB,GAAG,OAAC;KACvC,MAAM,CAAC;IACN,SAAS,EAAE,OAAC,CAAC,MAAM,CACjB,OAAC,CAAC,MAAM,EAAE,EACV,OAAC,CAAC,MAAM,CAAC;QACP,YAAY,EAAE,OAAC,CAAC,MAAM,EAAE;QACxB,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;KAClB,CAAC,CACH;IACD,SAAS,EAAE,OAAC,CAAC,MAAM,CACjB,OAAC,CAAC,MAAM,EAAE,EACV,OAAC,CAAC,MAAM,CACN,OAAC,CAAC,MAAM,EAAE,EACV,OAAC,CAAC,KAAK,CACL,OAAC,CAAC,MAAM,CAAC;QACP,YAAY,EAAE,OAAC,CAAC,MAAM,EAAE;QACxB,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;KAClB,CAAC,CACH,CACF,CACF;CACF,CAAC;KACD,SAAS,CAAC,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,EAAE;IACtC,MAAM,UAAU,GAAG,IAAI,GAAG,EAAoB,CAAC;IAE/C,KAAK,MAAM,iBAAiB,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;QACtD,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,GAAG,iBAAiB,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;QACtE,MAAM,QAAQ,GAAG,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;QAC5C,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACvB,UAAU,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;KAChC;IAED,KAAK,MAAM,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;QAC1D,MAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACzC,UAAU,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;KAChC;IAED,OAAO,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;AACxC,CAAC,CAAC,CAAC","sourcesContent":["import { z } from 'zod';\n\nexport const BicepResourceVersionIndex = z\n  .object({\n    Resources: z.record(\n      z.string(),\n      z.object({\n        RelativePath: z.string(),\n        Index: z.number(),\n      })\n    ),\n    Functions: z.record(\n      z.string(),\n      z.record(\n        z.string(),\n        z.array(\n          z.object({\n            RelativePath: z.string(),\n            Index: z.number(),\n          })\n        )\n      )\n    ),\n  })\n  .transform(({ Resources, Functions }) => {\n    const releaseMap = new Map<string, string[]>();\n\n    for (const resourceReference of Object.keys(Resources)) {\n      const [type, version] = resourceReference.toLowerCase().split('@', 2);\n      const versions = releaseMap.get(type) ?? [];\n      versions.push(version);\n      releaseMap.set(type, versions);\n    }\n\n    for (const [type, versionMap] of Object.entries(Functions)) {\n      const versions = Object.keys(versionMap);\n      releaseMap.set(type, versions);\n    }\n\n    return Object.fromEntries(releaseMap);\n  });\n\nexport type BicepResourceVersionIndex = z.infer<\n  typeof BicepResourceVersionIndex\n>;\n"]}