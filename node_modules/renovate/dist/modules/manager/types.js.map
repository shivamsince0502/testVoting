{"version":3,"file":"types.js","sourceRoot":"","sources":["../../../lib/modules/manager/types.ts"],"names":[],"mappings":"","sourcesContent":["import type { ReleaseType } from 'semver';\nimport type {\n  MatchStringsStrategy,\n  RegexManagerTemplates,\n  UpdateType,\n  ValidationMessage,\n} from '../../config/types';\nimport type { Category } from '../../constants';\nimport type { ModuleApi, RangeStrategy, SkipReason } from '../../types';\nimport type { FileChange } from '../../util/git/types';\nimport type { MergeConfidence } from '../../util/merge-confidence/types';\n\nexport type Result<T> = T | Promise<T>;\n\nexport interface ManagerData<T> {\n  managerData?: T;\n}\n\nexport interface ExtractConfig extends CustomExtractConfig {\n  registryAliases?: Record<string, string>;\n  npmrc?: string;\n  npmrcMerge?: boolean;\n  skipInstalls?: boolean | null;\n}\n\nexport interface CustomExtractConfig extends RegexManagerTemplates {\n  autoReplaceStringTemplate?: string;\n  matchStrings?: string[];\n  matchStringsStrategy?: MatchStringsStrategy;\n}\n\nexport interface UpdateArtifactsConfig {\n  isLockFileMaintenance?: boolean;\n  constraints?: Record<string, string>;\n  composerIgnorePlatformReqs?: string[];\n  goGetDirs?: string[];\n  currentValue?: string;\n  postUpdateOptions?: string[];\n  ignorePlugins?: boolean;\n  ignoreScripts?: boolean;\n  updateType?: UpdateType;\n  newValue?: string;\n  newVersion?: string;\n  newMajor?: number;\n  registryAliases?: Record<string, string>;\n}\n\nexport interface RangeConfig<T = Record<string, any>> extends ManagerData<T> {\n  currentValue?: string;\n  depName?: string;\n  depType?: string;\n  manager?: string;\n  rangeStrategy: RangeStrategy;\n}\n\nexport interface PackageFileContent<T = Record<string, any>>\n  extends ManagerData<T> {\n  autoReplaceStringTemplate?: string;\n  extractedConstraints?: Record<string, string>;\n  datasource?: string;\n  registryUrls?: string[];\n  additionalRegistryUrls?: string[];\n  deps: PackageDependency[];\n  lockFiles?: string[];\n  npmrc?: string;\n  packageFileVersion?: string;\n  skipInstalls?: boolean | null;\n  matchStrings?: string[];\n  matchStringsStrategy?: MatchStringsStrategy;\n}\n\nexport interface PackageFile<T = Record<string, any>>\n  extends PackageFileContent<T> {\n  packageFile: string;\n}\n\nexport interface LookupUpdate {\n  bucket?: string;\n  branchName?: string;\n  commitMessageAction?: string;\n  isBump?: boolean;\n  isLockfileUpdate?: boolean;\n  isPin?: boolean;\n  isPinDigest?: boolean;\n  isRange?: boolean;\n  isRollback?: boolean;\n  isReplacement?: boolean;\n  newDigest?: string;\n  newMajor?: number;\n  newMinor?: number;\n  newName?: string;\n  newValue: string;\n  semanticCommitType?: string;\n  pendingChecks?: boolean;\n  pendingVersions?: string[];\n  newVersion?: string;\n  updateType?: UpdateType;\n  mergeConfidenceLevel?: MergeConfidence | undefined;\n  userStrings?: Record<string, string>;\n  checksumUrl?: string;\n  downloadUrl?: string;\n  releaseTimestamp?: any;\n  registryUrl?: string;\n}\n\nexport interface PackageDependency<T = Record<string, any>>\n  extends ManagerData<T> {\n  currentValue?: string | null;\n  currentDigest?: string;\n  depName?: string;\n  depType?: string;\n  fileReplacePosition?: number;\n  groupName?: string;\n  lineNumber?: number;\n  packageName?: string;\n  target?: string;\n  versioning?: string;\n  dataType?: string;\n  enabled?: boolean;\n  bumpVersion?: ReleaseType | string;\n  npmPackageAlias?: boolean;\n  packageFileVersion?: string;\n  gitRef?: boolean;\n  sourceUrl?: string | null;\n  pinDigests?: boolean;\n  currentRawValue?: string;\n  major?: { enabled?: boolean };\n  prettyDepType?: string;\n  newValue?: string;\n  warnings?: ValidationMessage[];\n  commitMessageTopic?: string;\n  currentDigestShort?: string;\n  datasource?: string;\n  deprecationMessage?: string;\n  digestOneAndOnly?: boolean;\n  fixedVersion?: string;\n  currentVersion?: string;\n  lockedVersion?: string;\n  propSource?: string;\n  registryUrls?: string[] | null;\n  rangeStrategy?: RangeStrategy;\n  skipReason?: SkipReason;\n  sourceLine?: number;\n  newVersion?: string;\n  updates?: LookupUpdate[];\n  replaceString?: string;\n  autoReplaceStringTemplate?: string;\n  editFile?: string;\n  separateMinorPatch?: boolean;\n  extractVersion?: string;\n  isInternal?: boolean;\n  variableName?: string;\n  indentation?: string;\n}\n\nexport interface Upgrade<T = Record<string, any>> extends PackageDependency<T> {\n  workspace?: string;\n  isLockfileUpdate?: boolean;\n  currentRawValue?: any;\n  depGroup?: string;\n  lockFiles?: string[];\n  name?: string;\n  newDigest?: string;\n  newFrom?: string;\n  newMajor?: number;\n  newName?: string;\n  newValue?: string;\n  packageFile?: string;\n  rangeStrategy?: RangeStrategy;\n  newVersion?: string;\n  updateType?: UpdateType;\n  version?: string;\n  isLockFileMaintenance?: boolean;\n  isRemediation?: boolean;\n  isVulnerabilityAlert?: boolean;\n  vulnerabilitySeverity?: string;\n  registryUrls?: string[] | null;\n  currentVersion?: string;\n  replaceString?: string;\n}\n\nexport interface ArtifactError {\n  lockFile?: string;\n  stderr?: string;\n}\n\nexport interface UpdateArtifactsResult {\n  artifactError?: ArtifactError;\n  file?: FileChange;\n}\n\nexport interface UpdateArtifact<T = Record<string, unknown>> {\n  packageFileName: string;\n  updatedDeps: Upgrade<T>[];\n  newPackageFileContent: string;\n  config: UpdateArtifactsConfig;\n}\n\nexport interface UpdateDependencyConfig<T = Record<string, any>> {\n  fileContent: string;\n  upgrade: Upgrade<T>;\n}\n\nexport interface BumpPackageVersionResult {\n  bumpedContent: string | null;\n}\n\nexport interface UpdateLockedConfig {\n  packageFile: string;\n  packageFileContent?: string;\n  lockFile: string;\n  lockFileContent?: string;\n  depName: string;\n  currentVersion: string;\n  newVersion: string;\n  allowParentUpdates?: boolean;\n  allowHigherOrRemoved?: boolean;\n}\n\nexport interface UpdateLockedResult {\n  status: 'unsupported' | 'updated' | 'already-updated' | 'update-failed';\n  files?: Record<string, string>;\n}\n\nexport interface GlobalManagerConfig {\n  npmrc?: string;\n  npmrcMerge?: boolean;\n}\n\nexport interface ManagerApi extends ModuleApi {\n  defaultConfig: Record<string, unknown>;\n\n  categories?: Category[];\n  supportsLockFileMaintenance?: boolean;\n\n  supportedDatasources: string[];\n\n  bumpPackageVersion?(\n    content: string,\n    currentValue: string,\n    bumpVersion: ReleaseType | string\n  ): Result<BumpPackageVersionResult>;\n\n  detectGlobalConfig?(): Result<GlobalManagerConfig>;\n\n  extractAllPackageFiles?(\n    config: ExtractConfig,\n    files: string[]\n  ): Result<PackageFile[] | null>;\n\n  extractPackageFile?(\n    content: string,\n    packageFile?: string,\n    config?: ExtractConfig\n  ): Result<PackageFileContent | null>;\n\n  getRangeStrategy?(config: RangeConfig): RangeStrategy;\n\n  updateArtifacts?(\n    updateArtifact: UpdateArtifact\n  ): Result<UpdateArtifactsResult[] | null>;\n\n  updateDependency?(\n    updateDependencyConfig: UpdateDependencyConfig\n  ): Result<string | null>;\n\n  updateLockedDependency?(\n    config: UpdateLockedConfig\n  ): Result<UpdateLockedResult>;\n}\n\n// TODO: name and properties used by npm manager\nexport interface PostUpdateConfig<T = Record<string, any>>\n  extends Record<string, any>,\n    ManagerData<T> {\n  updatedPackageFiles?: FileChange[];\n  postUpdateOptions?: string[];\n  skipInstalls?: boolean | null;\n  ignoreScripts?: boolean;\n\n  packageFile?: string;\n\n  upgrades: Upgrade[];\n  npmLock?: string;\n  yarnLock?: string;\n  branchName: string;\n  reuseExistingBranch?: boolean;\n}\n"]}