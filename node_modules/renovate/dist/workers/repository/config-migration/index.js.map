{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../lib/workers/repository/config-migration/index.ts"],"names":[],"mappings":";;;AACA,qCAAsD;AACtD,0DAA6D;AAC7D,6BAA+C;AAExC,KAAK,UAAU,eAAe,CACnC,MAAsB,EACtB,UAAoB;IAEpB,IAAI,MAAM,CAAC,eAAe,EAAE;QAC1B,MAAM,kBAAkB,GAAG,MAAM,mCAAmB,CAAC,QAAQ,EAAE,CAAC;QAChE,MAAM,eAAe,GAAG,MAAM,IAAA,mCAA0B,EACtD,MAAM,EACN,kBAAkB,CACnB,CAAC,CAAC,+BAA+B;QAClC,IAAI,eAAe,EAAE;YACnB,UAAU,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YACjC,MAAM,IAAA,4BAAuB,EAAC,MAAM,EAAE,kBAAmB,CAAC,CAAC;SAC5D;QACD,mCAAmB,CAAC,KAAK,EAAE,CAAC;KAC7B;AACH,CAAC;AAhBD,0CAgBC","sourcesContent":["import type { RenovateConfig } from '../../../config/types';\nimport { checkConfigMigrationBranch } from './branch';\nimport { MigratedDataFactory } from './branch/migrated-data';\nimport { ensureConfigMigrationPr } from './pr';\n\nexport async function configMigration(\n  config: RenovateConfig,\n  branchList: string[]\n): Promise<void> {\n  if (config.configMigration) {\n    const migratedConfigData = await MigratedDataFactory.getAsync();\n    const migrationBranch = await checkConfigMigrationBranch(\n      config,\n      migratedConfigData\n    ); // null if migration not needed\n    if (migrationBranch) {\n      branchList.push(migrationBranch);\n      await ensureConfigMigrationPr(config, migratedConfigData!);\n    }\n    MigratedDataFactory.reset();\n  }\n}\n"]}